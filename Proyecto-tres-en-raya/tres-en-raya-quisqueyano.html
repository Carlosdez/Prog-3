<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tres en Raya Quisqueyano</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #002d62, #ce1126);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .app {
            max-width: 600px;
            width: 100%;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border: 3px solid #002d62;
        }

        .app-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f8f9fa;
        }

        .app-header h1 {
            color: #002d62;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            color: #ce1126;
            font-size: 1.3rem;
            font-weight: bold;
            font-style: italic;
        }

        /* Score Board */
        .score-board {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #dee2e6;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .score-board h2 {
            text-align: center;
            color: #002d62;
            margin-bottom: 20px;
            font-size: 1.6rem;
            font-weight: bold;
        }

        .score-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .score-table th, .score-table td {
            padding: 15px;
            text-align: center;
            border: 2px solid #dee2e6;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .score-table th {
            background-color: #002d62;
            color: white;
            font-size: 1.1rem;
        }

        .taino-header {
            background-color: #002d62 !important;
        }

        .caribe-header {
            background-color: #ce1126 !important;
        }

        .draw-header {
            background-color: #6c757d !important;
        }

        .taino-score {
            color: #002d62;
            font-size: 1.8rem;
            background-color: #e8f4f8;
        }

        .caribe-score {
            color: #ce1126;
            font-size: 1.8rem;
            background-color: #fde8e8;
        }

        .draw-score {
            color: #6c757d;
            font-size: 1.8rem;
            background-color: #f8f9fa;
        }

        /* Board */
        .board-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-status {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 25px;
            color: #002d62;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }

        .winner-message {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border-color: #c3e6cb;
            font-size: 1.7rem;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 25px auto;
            max-width: 350px;
            background: #002d62;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .cell {
            aspect-ratio: 1;
            background: white;
            border: 4px solid #002d62;
            border-radius: 12px;
            font-size: 3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Arial', sans-serif;
        }

        .cell:hover {
            background: #e9ecef;
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .cell.x {
            color: #002d62;
            border-color: #002d62;
            text-shadow: 2px 2px 4px rgba(0, 45, 98, 0.3);
        }

        .cell.o {
            color: #ce1126;
            border-color: #ce1126;
            text-shadow: 2px 2px 4px rgba(206, 17, 38, 0.3);
        }

        .winning-cell {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0) !important;
            animation: celebrate 0.6s ease-in-out;
        }

        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1); }
        }

        /* Buttons */
        .board-controls {
            text-align: center;
            margin-top: 20px;
        }

        .reset-button, .clear-history-btn {
            background: linear-gradient(135deg, #002d62, #0044aa);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .clear-history-btn {
            background: linear-gradient(135deg, #ce1126, #e74c3c);
            font-size: 1rem;
            padding: 12px 25px;
        }

        .reset-button:hover {
            background: linear-gradient(135deg, #001f4d, #003388);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .clear-history-btn:hover {
            background: linear-gradient(135deg, #a50d1e, #c0392b);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .reset-button:active, .clear-history-btn:active {
            transform: translateY(-1px);
        }

        /* History Controls */
        .history-controls {
            text-align: center;
            margin-top: 15px;
        }

        /* Game History */
        .game-history {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #dee2e6;
        }

        .game-history h3 {
            color: #002d62;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.4rem;
            font-weight: bold;
        }

        .no-history {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 20px;
        }

        .game-history ul {
            list-style: none;
            max-height: 250px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .game-history ul::-webkit-scrollbar {
            width: 8px;
        }

        .game-history ul::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .game-history ul::-webkit-scrollbar-thumb {
            background: #002d62;
            border-radius: 10px;
        }

        .game-history ul::-webkit-scrollbar-thumb:hover {
            background: #001f4d;
        }

        .history-item {
            padding: 12px 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
            border-left: 5px solid #002d62;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
        }

        .history-item:hover {
            transform: translateX(5px);
        }

        .history-item.taino {
            border-left-color: #002d62;
            background: linear-gradient(135deg, #e8f4f8, #ffffff);
        }

        .history-item.caribe {
            border-left-color: #ce1126;
            background: linear-gradient(135deg, #fde8e8, #ffffff);
        }

        .history-item.empate {
            border-left-color: #6c757d;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
        }

        .history-date {
            color: #495057;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .history-winner {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .history-item.taino .history-winner {
            background: #002d62;
            color: white;
        }

        .history-item.caribe .history-winner {
            background: #ce1126;
            color: white;
        }

        .history-item.empate .history-winner {
            background: #6c757d;
            color: white;
        }

        .history-moves {
            color: #6c757d;
            font-size: 0.85rem;
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 12px;
            border: 1px solid #dee2e6;
        }

        /* Footer */
        .app-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 3px solid #e9ecef;
            color: #6c757d;
            font-style: italic;
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app {
                padding: 20px;
                margin: 10px;
            }
            
            .app-header h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .cell {
                font-size: 2.5rem;
            }
            
            .game-status {
                font-size: 1.3rem;
            }
            
            .score-table th, .score-table td {
                padding: 12px 8px;
                font-size: 1.1rem;
            }
            
            .history-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .reset-button, .clear-history-btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .app {
                padding: 15px;
            }
            
            .app-header h1 {
                font-size: 1.7rem;
            }
            
            .board {
                max-width: 300px;
                gap: 8px;
                padding: 10px;
            }
            
            .cell {
                font-size: 2rem;
            }
            
            .game-status {
                font-size: 1.1rem;
                padding: 10px;
            }
            
            .score-board {
                padding: 15px;
            }
        }

        /* Instructions */
        .instructions {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #002d62;
        }

        .instructions h3 {
            color: #002d62;
            margin-bottom: 10px;
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            color: #495057;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Componente Cell
        const Cell = ({ value, onClick, isWinningCell }) => {
            return (
                <button 
                    className={`cell ${value ? value.toLowerCase() : ''} ${isWinningCell ? 'winning-cell' : ''}`}
                    onClick={onClick}
                >
                    {value}
                </button>
            );
        };

        // Componente ScoreBoard
        const ScoreBoard = ({ scores, onClearHistory }) => {
            return (
                <div className="score-board">
                    <h2>Puntaje Quisqueyano</h2>
                    
                    <table className="score-table">
                        <thead>
                            <tr>
                                <th className="taino-header">Taino (X)</th>
                                <th className="draw-header">Empates</th>
                                <th className="caribe-header">Caribe (O)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td className="taino-score">{scores.taino}</td>
                                <td className="draw-score">{scores.empates}</td>
                                <td className="caribe-score">{scores.caribe}</td>
                            </tr>
                        </tbody>
                    </table>

                    <div className="history-controls">
                        <button 
                            className="clear-history-btn"
                            onClick={onClearHistory}
                        >
                            üóëÔ∏è Limpiar Historial Completo
                        </button>
                    </div>
                </div>
            );
        };

        // Componente Board
        const Board = ({ onGameEnd, onAddToHistory }) => {
            const [cells, setCells] = useState(Array(9).fill(null));
            const [isXNext, setIsXNext] = useState(true);
            const [movesCount, setMovesCount] = useState(0);

            const calculateWinner = (squares) => {
                const lines = [
                    [0, 1, 2], [3, 4, 5], [6, 7, 8], // Filas
                    [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columnas
                    [0, 4, 8], [2, 4, 6]             // Diagonales
                ];

                for (let i = 0; i < lines.length; i++) {
                    const [a, b, c] = lines[i];
                    if (squares[a] && squares[a] === squares[b] && squares[a] === squares[c]) {
                        return squares[a];
                    }
                }

                return squares.includes(null) ? null : 'Empate';
            };

            const handleClick = (index) => {
                if (cells[index] || calculateWinner(cells)) return;

                const newCells = [...cells];
                newCells[index] = isXNext ? 'X' : 'O';
                setCells(newCells);
                setIsXNext(!isXNext);
                setMovesCount(movesCount + 1);

                const winner = calculateWinner(newCells);
                if (winner) {
                    onGameEnd(winner);
                    onAddToHistory(winner, movesCount + 1);
                }
            };

            const resetGame = () => {
                setCells(Array(9).fill(null));
                setIsXNext(true);
                setMovesCount(0);
            };

            const winner = calculateWinner(cells);
            const status = winner 
                ? winner === 'Empate' 
                    ? '¬°Empate! ü§ù' 
                    : `¬°${winner === 'X' ? 'Taino' : 'Caribe'} gana! üéâ`
                : `Pr√≥ximo jugador: ${isXNext ? 'Taino (X)' : 'Caribe (O)'}`;

            return (
                <div className="board-container">
                    <div className={`game-status ${winner ? 'winner-message' : ''}`}>
                        {status}
                    </div>
                    
                    <div className="board">
                        {cells.map((cell, index) => (
                            <Cell
                                key={index}
                                value={cell}
                                onClick={() => handleClick(index)}
                                isWinningCell={winner && !winner.includes('Empate')}
                            />
                        ))}
                    </div>
                    
                    <div className="board-controls">
                        <button className="reset-button" onClick={resetGame}>
                            {winner ? 'Jugar de Nuevo! üá©üá¥' : 'Reiniciar Juego'}
                        </button>
                    </div>
                </div>
            );
        };

        // Componente principal App
        const TresEnRayaQuisqueyano = () => {
            const [scores, setScores] = useState({
                taino: 0,
                caribe: 0,
                empates: 0
            });
            const [gameHistory, setGameHistory] = useState([]);

            // Cargar datos del localStorage al iniciar
            useEffect(() => {
                const savedScores = localStorage.getItem('tresEnRayaScores');
                const savedHistory = localStorage.getItem('tresEnRayaHistory');
                
                if (savedScores) {
                    setScores(JSON.parse(savedScores));
                }
                if (savedHistory) {
                    setGameHistory(JSON.parse(savedHistory));
                }
            }, []);

            // Guardar en localStorage cuando cambien los datos
            useEffect(() => {
                localStorage.setItem('tresEnRayaScores', JSON.stringify(scores));
                localStorage.setItem('tresEnRayaHistory', JSON.stringify(gameHistory));
            }, [scores, gameHistory]);

            const updateScores = (winner) => {
                setScores(prevScores => {
                    const newScores = { ...prevScores };
                    if (winner === 'X') {
                        newScores.taino += 1;
                    } else if (winner === 'O') {
                        newScores.caribe += 1;
                    } else {
                        newScores.empates += 1;
                    }
                    return newScores;
                });
            };

            const addGameToHistory = (winner, moves) => {
                const newGame = {
                    id: Date.now(),
                    date: new Date().toLocaleString('es-DO'),
                    winner: winner === 'X' ? 'Taino' : winner === 'O' ? 'Caribe' : 'Empate',
                    moves: moves
                };
                setGameHistory(prev => [newGame, ...prev].slice(0, 10));
            };

            const clearHistory = () => {
                if (window.confirm('¬øEst√°s seguro de que quieres limpiar todo el historial?')) {
                    setScores({ taino: 0, caribe: 0, empates: 0 });
                    setGameHistory([]);
                    localStorage.removeItem('tresEnRayaScores');
                    localStorage.removeItem('tresEnRayaHistory');
                }
            };

            return (
                <div className="app">
                    <header className="app-header">
                        <h1>üèùÔ∏è Tres en Raya Quisqueyano</h1>
                        <p className="subtitle">Taino (X) vs Caribe (O)</p>
                    </header>

                    <ScoreBoard 
                        scores={scores} 
                        onClearHistory={clearHistory}
                    />

                    <Board 
                        onGameEnd={updateScores}
                        onAddToHistory={addGameToHistory}
                    />

                    <div className="game-history">
                        <h3>üìä Historial Reciente</h3>
                        {gameHistory.length === 0 ? (
                            <p className="no-history">No hay partidas jugadas todav√≠a</p>
                        ) : (
                            <ul>
                                {gameHistory.map(game => (
                                    <li key={game.id} className={`history-item ${game.winner.toLowerCase()}`}>
                                        <span className="history-date">{game.date}</span>
                                        <span className="history-winner">Ganador: {game.winner}</span>
                                        <span className="history-moves">Movimientos: {game.moves}</span>
                                    </li>
                                ))}
                            </ul>
                        )}
                    </div>

                    <div className="instructions">
                        <h3>üéÆ C√≥mo Jugar</h3>
                        <ul>
                            <li><strong>Taino (X)</strong> y <strong>Caribe (O)</strong> alternan turnos</li>
                            <li>Haz clic en cualquier celda vac√≠a para colocar tu s√≠mbolo</li>
                            <li>Gana formando una l√≠nea de 3 s√≠mbolos iguales (horizontal, vertical o diagonal)</li>
                            <li>Si se llena el tablero sin ganador, es un empate</li>
                            <li>Las puntuaciones se guardan autom√°ticamente</li>
                        </ul>
                    </div>

                    <footer className="app-footer">
                        <p>¬°Con el sabor aut√©ntico de Quisqueya! üá©üá¥</p>
                    </footer>
                </div>
            );
        };

        ReactDOM.render(<TresEnRayaQuisqueyano />, document.getElementById('root'));
    </script>
</body>
</html>
